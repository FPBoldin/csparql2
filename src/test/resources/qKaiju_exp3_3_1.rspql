PREFIX tr: <http://polimi.deib/tracing#>
PREFIX ht: <http://polimi.deib/hotrod#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

REGISTER RSTREAM <s1> AS
SELECT ?did (COUNT(*) AS ?numDriverToCustomer)
FROM NAMED WINDOW <win> ON <jsonTraces> [RANGE PT10S STEP PT10S]
WHERE  {
    WINDOW <win> {
        ?d ht:driverToCustomer ?c.
        ?d ht:licensePlateNumber ?did.
    }
}
GROUP BY ?did

